#set( $dollar = '$' )
<strong>Here you would put the actual form to start the process</strong>

<p>
  You can use this form through Camunda Tasklist
  by setting the formKey of a BPMN Start Event to:
  <code>embedded:/forms/start-form.html</code>
</p>

<form class="form-horizontal">
  <div class="form-group">
    <label class="control-label">Your Name</label>
    <div class="controls">
      <input type="text" 
             cam-variable-name="name"
             cam-variable-type="String"
             required
             class="form-control" />
    </div>
  </div>

  <script cam-script type="text/form-script">
    // custom JavaScript goes here

    inject(['Uri', function(Uri) {

      camForm.on('submit', function() {
        // this callback is executed when the form is submitted, *before* the submit request to
        // the server is executed

        // store data in domain service and retrieve business key
        ${dollar}.ajax({
          url: Uri.appUri('engine://engine/:engine/history/activity-instance/count'),
          method: 'POST',
          async: false,
          data: JSON.stringify({ finished: true }),
          contentType: 'application/json',
          dataType: 'json',
          success: function (data) {
            camForm.businessKey = data.count
          }
        });

      });

    }]);
  </script>
</form>
